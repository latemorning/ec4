var AXModal=Class.create(AXJ,{initialize:function(AXJ_super){AXJ_super();this.config.maskCss="AXMask";this.config.windowBoxCss="AXModalBox";this.config.padding="0";this.config.defaultTop=10;this.config.animateDuration=300;this.config.autoHide=false;this.config.windowID="AXModal"+AXUtil.timekey();this.config.contentDivClass=(AXConfig.AXModal)?AXConfig.AXModal.contentDivClass:"bodyHeightDiv";this.config.displayLoading=true;this.config.viewMode="dx";this.config.opendModalID="";this.config.scrollLock=false;this.config.closeButton=true;},init:function(){var cfg=this.config;this.mask=axdom("<div class=\""+cfg.maskCss+"\"></div>");if(cfg.mediaQuery){var _viewMode="",clientWidth=axf.clientWidth();axf.each(cfg.mediaQuery,function(k,v){if(Object.isObject(v)){if(v.min!=undefined&&v.max!=undefined){if(v.min<=clientWidth&&clientWidth<=v.max){_viewMode=(k=="dx")?"dx":"mx";return false;}}else{if(v.min<=clientWidth){_viewMode=(k=="dx")?"dx":"mx";return false;}}}});if(_viewMode!=""){cfg.viewMode=_viewMode;}}},setWidth:function(width){var cfg=this.config;if(width){cfg.width=width;this.config.fixedWidth=true;}else{cfg.width=undefined;this.config.fixedWidth=false;}axdom("#"+cfg.windowID).css({width:width});var maskWidth=axdom("#"+cfg.windowID).outerWidth();var maskLeft=(axdom(document.body).width()/2)-(maskWidth/2);if(maskLeft<0)maskLeft=0;axdom("#"+cfg.windowID).css({left:maskLeft});},open:function(http){var cfg=this.config;if(this._windowOpend)return;mask.open();this.winID="mdw"+AXUtil.timekey();this.frmID="frm"+AXUtil.timekey();var maskWidth,maskLeft;if(this.config.width){maskWidth=this.config.width;maskLeft=(axdom(document.body).width()/2)-(this.config.width/2);this.config.fixedWidth=true;}else{maskWidth=axdom(document.body).width()-50;maskLeft=10;this.config.fixedWidth=false;}if(http.width){maskWidth=http.width;maskLeft=(axdom(document.body).width()/2)-(http.width/2);this.config.fixedWidth=true;}var maskTop=this.config.defaultTop;if(http.top!=undefined){maskTop=http.top;}else{maskTop=axdom(window).scrollTop()+100;}if(maskLeft<0)maskLeft=0;var po=[];po.push("<div id='"+this.config.windowID+"' class='"+this.config.windowBoxCss+"' style='top:"+maskTop+"px;left:"+maskLeft+"px;width:"+maskWidth+"px;'>");po.push("	<div class='windowbox' id='"+this.winID+"_box' style='padding:"+this.config.padding+"px'>");if(cfg.displayLoading){po.push("		<div id='"+this.config.windowID+"_loading' style='position:absolute;left:0px;top:0px;width:100%;padding:50px 0px 0px 0px;' align='center'>");po.push("		<div class=\"AXLoading\"></div>");po.push("		<br/><br><span class='blue'>페이지를 로딩 중입니다. 잠시만 기다려 주세요.</span></div>");}var closeButton=(http.closeButton==undefined)?cfg.closeButton:http.closeButton;if(closeButton){po.push("		<a id='"+this.config.windowID+"_close' class='closeBtn'>닫기</a>");}po.push("		<form name='"+this.frmID+"' method='"+(http.method||"post")+"' target='"+this.winID+"' action='"+http.url+"'>");po.push("		<input type='hidden' name='winID' value='"+this.winID+"' />");if(isNaN(http.pars.length)){axdom.each(http.pars,function(key,val){po.push("		<input type='hidden' name='"+key+"' value='"+val+"' />");});}else{axdom.each(http.pars,function(){axdom.each(this,function(key,val){po.push("		<input type='hidden' name='"+key+"' value='"+val+"' />");});});}if(AXConfig.AXModal.pars){var appendPars={};if(Object.isString(AXConfig.AXModal.pars)){appendPars=AXConfig.AXModal.pars.queryToObject();}axdom.each(appendPars,function(key,val){po.push("<input type='hidden' name='"+key+"' value='"+val+"' />");});}po.push("		</form>");po.push("		<iframe src='' name='"+this.winID+"' id='"+this.winID+"' frameborder='0' class='windowboxFrame' style='width:100%;overflow:-y:hidden;' scrolling='no'></iframe>");po.push("	</div>");po.push("</div>");if(this.config.appendTargetID){axdom("#"+this.config.appendTargetID).append(po.join(''));}else{axdom(document.body).append(po.join(''));}axdom("#"+cfg.windowID).data("width",maskWidth);axdom("#"+cfg.windowID).data("top",maskTop);if(cfg.viewMode=="mx"){axdom("#"+cfg.windowID).css({left:0,top:axdom(window).scrollTop(),width:"100%"});}var loadingID=this.config.windowID+"_loading";var _winID=this.winID;var _frmID=this.frmID;document[_frmID].submit();var keydown=this.keydown.bind(this);axdom("#"+this.winID).bind("load",function(){var myIframe=window[_winID];var bodyHeight=axdom(myIframe.document).innerHeight();if(axdom(myIframe.document.body).find("."+cfg.contentDivClass).get(0)){bodyHeight=axdom(myIframe.document.body).find("."+cfg.contentDivClass).outerHeight();}axdom(this).css({height:(bodyHeight)},cfg.animateDuration,"cubicInOut");axdom("#"+_winID+"_box").css({height:(bodyHeight)},cfg.animateDuration,"cubicInOut");if(cfg.displayLoading)axdom("#"+loadingID).fadeOut("slow");axdom("#"+_winID).addClass("loaded");if(http.closeByEscKey){axdom(myIframe.document.body).bind("keydown.AXModal",keydown);}});axdom("#"+this.config.windowID+"_close").bind("click",this.close.bind(this));if(http.closeByEscKey){axdom(document.body).bind("keydown.AXModal",keydown);}this._windowOpend=true;axdom(window).unbind("resize.AXModal");axdom(window).bind("resize.AXModal",this.onDocResize.bind(this));if(cfg.scrollLock==true){axdom(document.body).css({'overflow':'hidden'});}},openI:function(http){var cfg=this.config;if(this._windowOpend)return;mask.open();this.winID="mdw"+AXUtil.timekey();this.frmID="frm"+AXUtil.timekey();var maskWidth,maskLeft;if(this.config.width){maskWidth=this.config.width;maskLeft=(axdom(document.body).width()/2)-(this.config.width/2);this.config.fixedWidth=true;}else{maskWidth=axdom(document.body).width()-50;maskLeft=10;this.config.fixedWidth=false;}if(http.width){maskWidth=http.width;maskLeft=(axdom(document.body).width()/2)-(http.width/2);this.config.fixedWidth=true;}var maskTop=this.config.defaultTop;if(http.top!=undefined){maskTop=http.top;}else{maskTop=axdom(window).scrollTop()+100;}if(maskLeft<0)maskLeft=0;var po=[];po.push("<div id='"+this.config.windowID+"' class='"+this.config.windowBoxCss+"' style='top:"+maskTop+"px;left:"+maskLeft+"px;width:"+maskWidth+"px;'>");po.push("	<div class='windowbox' id='"+this.winID+"_box' style='padding:"+this.config.padding+"px'>");po.push("		<div id='"+this.config.windowID+"_loading' style='position:absolute;left:0px;top:0px;width:"+maskWidth+"px;padding:50px 0px 0px 0px;' align='center'>");po.push("		<div class=\"AXLoading\"></div>");po.push("		<br/><br><span class='blue'>페이지를 로딩 중입니다. 잠시만 기다려 주세요.</span></div>");var closeButton=(http.closeButton==undefined)?cfg.closeButton:http.closeButton;if(closeButton){po.push("		<a href='#modsExecption' id='"+this.config.windowID+"_close' class='closeBtn'>닫기</a>");}po.push("		<form name='"+this.frmID+"' method='post' target='"+this.winID+"' action='"+http.url+"'>");po.push("		<input type='hidden' name='winID' value='"+this.winID+"' />");if(isNaN(http.pars.length)){axdom.each(http.pars,function(key,val){po.push("		<input type='hidden' name='"+key+"' value='"+val+"' />");});}else{axdom.each(http.pars,function(){axdom.each(this,function(key,val){po.push("		<input type='hidden' name='"+key+"' value='"+val+"' />");});});}if(AXConfig.AXModal.pars){var appendPars={};if(Object.isString(AXConfig.AXModal.pars)){appendPars=AXConfig.AXModal.pars.queryToObject();}axdom.each(appendPars,function(key,val){po.push("<input type='hidden' name='"+key+"' value='"+val+"' />");});}po.push("		</form>");if(http.maxHeight){po.push("		<iframe src='' name='"+this.winID+"' id='"+this.winID+"' frameborder='0' class='windowboxFrame' style='width:100%;overflow:-y:hidden;' scrolling='auto'></iframe>");}else{po.push("		<iframe src='' name='"+this.winID+"' id='"+this.winID+"' frameborder='0' class='windowboxFrame' style='width:100%;overflow:-y:hidden;' scrolling='no'></iframe>");}po.push("	</div>");po.push("</div>");if(this.config.appendTargetID){axdom("#"+this.config.appendTargetID).append(po.join(''));}else{axdom(document.body).append(po.join(''));}var loadingID=this.config.windowID+"_loading";var _winID=this.winID;var _frmID=this.frmID;document[_frmID].submit();axdom("#"+this.winID).bind("load",function(){var myIframe=window[_winID];var bodyHeight=axdom(myIframe.document).innerHeight();if(axdom(myIframe.document.body).find("."+cfg.contentDivClass).get(0)){bodyHeight=axdom(myIframe.document.body).find("."+cfg.contentDivClass).outerHeight();}if(http.maxHeight){if(http.maxHeight<(bodyHeight.number()+maskTop.number()+10)){bodyHeight=http.maxHeight-maskTop.number()-10;}}axdom(this).css({height:(bodyHeight)},cfg.animateDuration,"cubicInOut");axdom("#"+_winID+"_box").css({height:(bodyHeight)},cfg.animateDuration,"cubicInOut");axdom("#"+loadingID).fadeOut("slow");axdom("#"+_winID).addClass("loaded");});axdom("#"+this.config.windowID+"_close").bind("click",this.close.bind(this));this._windowOpend=true;axdom(window).unbind("resize.AXModal");axdom(window).bind("resize.AXModal",this.onDocResize.bind(this));if(cfg.scrollLock==true){axdom(document.body).css({'overflow':'hidden'});}},windowResizeApply:function(){this.onDocResize();},openDiv:function(args){var cfg=this.config;mask.open();var modalID=cfg.opendModalID=args.modalID;if(AXgetId(modalID)){var modalTarget=$("#"+modalID);modalTarget.show();var maskTop=this.config.defaultTop;if(args.top!=undefined){maskTop=axdom(window).scrollTop()+args.top;}else{maskTop=axdom(window).scrollTop()+50;}if(cfg.viewMode=="mx"){maskTop=axdom(window).scrollTop();}if(args.verticalAlign){modalTarget.css({top:axf.clientHeight()/2-modalTarget.height()/2+axdom(window).scrollTop()})}else{modalTarget.css({"top":maskTop});}if(args.closeByEscKey){var keydown=this.keydown.bind(this);var keydownBind=function(){keydown(event,modalID);};axdom(document.body).bind("keydown.AXModal",keydownBind);}return;}var maskWidth,maskLeft;if(this.config.width){maskWidth=this.config.width;maskLeft=(axdom(document.body).width()/2)-(this.config.width/2);this.config.fixedWidth=true;}else{maskWidth=axdom(document.body).width()-50;maskLeft=10;this.config.fixedWidth=false;}if(args.width){maskWidth=args.width;maskLeft=(axdom(document.body).width()/2)-(args.width/2);this.config.fixedWidth=true;}var maskTop=this.config.defaultTop;if(args.top!=undefined){maskTop=axdom(window).scrollTop()+args.top;}else{maskTop=axdom(window).scrollTop()+50;}if(maskLeft<0)maskLeft=0;var po=[];po.push("<div id='"+modalID+"' class='"+this.config.windowBoxCss+"' style='top:"+maskTop+"px;left:"+maskLeft+"px;width:"+maskWidth+"px;'>");po.push("	<div class='windowbox' style='padding:"+this.config.padding+"px'>");var closeButton=(args.closeButton==undefined)?cfg.closeButton:args.closeButton;if(closeButton){po.push("		<a href='#modsExecption' id='"+modalID+"_close' class='closeBtn'>닫기</a>");}po.push("		<div id='"+modalID+"_content'></div>");po.push("	</div>");po.push("</div>");axdom(document.body).append(po.join(''));axdom("#"+modalID+"_content").append(axdom("#"+args.targetID));axdom("#"+cfg.opendModalID).data("width",maskWidth);axdom("#"+cfg.opendModalID).data("top",maskTop);if(cfg.viewMode=="mx"){axdom("#"+cfg.opendModalID).css({left:0,top:axdom(window).scrollTop(),width:"100%"});}var loadingID=modalID+"_loading";var closeBind=this.close.bind(this);var closeModal=function(event){closeBind(event,modalID);};axdom("#"+modalID+"_close").bind("click",closeModal);if(args.closeByEscKey){var keydown=this.keydown.bind(this);var keydownBind=function(){keydown(event,modalID);};axdom(document.body).bind("keydown.AXModal",keydownBind);}axdom(window).unbind("resize.AXModal");axdom(window).bind("resize.AXModal",this.onDocResize.bind(this));if(cfg.scrollLock==true){axdom(document.body).css({'overflow':'hidden'});}if(args.verticalAlign){var modalTarget=$("#"+modalID);$("#"+modalID).css({top:axf.clientHeight()/2-modalTarget.height()/2+axdom(window).scrollTop()})}},openNew:function(http){this.winID="mdw"+AXUtil.timekey();this.frmID="frm"+AXUtil.timekey();if(this.openWindow){this.openWindow.close();}this.openWindow=window.open("",(http.name||this.winID),http.options);this.openWindow.focus();if(http.title!=undefined){this.openWindow.document.title=http.title;}if(AXgetId(this.config.windowID))axdom("#"+this.config.windowID).remove();var po=[];po.push("<div id='"+this.config.windowID+"'>");po.push("		<form name='"+this.frmID+"' method='"+(http.method||"post")+"' target='"+(http.name||this.winID)+"' action='"+http.url+"'>");po.push("		<input type='hidden' name='winID' value='"+this.winID+"' />");if(isNaN(http.pars.length)){axdom.each(http.pars,function(key,val){po.push("		<input type='hidden' name='"+key+"' value='"+val+"' />");});}else{axdom.each(http.pars,function(){axdom.each(this,function(key,val){po.push("		<input type='hidden' name='"+key+"' value='"+val+"' />");});});}po.push("		</form>");po.push("</div>");axdom(document.body).append(po.join(''));document[this.frmID].submit();axdom("#"+this.config.windowID).remove();},keydown:function(event,modalID){if(event.keyCode==AXUtil.Event.KEY_ESC){this.close(event,modalID);}},close:function(event,modalID){var cfg=this.config;if(this.openWindow){this.openWindow.close();}if(event){if(event.type==undefined){modalID=event;}}if(modalID){axdom("#"+modalID).hide();this.config.opendModalID="";mask.close();}else{if(window[this.winID]){window[this.winID].location.href="about:blank";var windowID=this.config.windowID;setTimeout(function(){axdom("#"+windowID).remove();},1);mask.close();this._windowOpend=false;}}axdom(document.body).unbind("keydown.AXModal");if(this.config.onclose){this.config.onclose.call({winID:this.winID,windowID:this.config.windowID,modalID:modalID});}if(cfg.scrollLock==true){axdom(document.body).css({'overflow':'auto'});}},remove:function(event){var windowID=this.config.windowID;setTimeout(function(){axdom("#"+windowID).remove();},1);mask.close();axdom(document.body).css({'overflow':'auto'});this._windowOpend=false;},resize:function(event){var cfg=this.config;var _winID=this.winID;setTimeout(function(){try{var myIframe=window[_winID];var doc=(myIframe.contentDocument)?myIframe.contentDocument:myIframe.contentWindow.document;var bodyHeight=axdom(doc).innerHeight();if(doc.body&&axdom(doc.body).find("."+cfg.contentDivClass).get(0)){bodyHeight=axdom(doc.body).find("."+cfg.contentDivClass).outerHeight();}axdom("#"+_winID).css({height:(bodyHeight)},cfg.animateDuration,"cubicInOut");axdom("#"+_winID+"_box").css({height:(bodyHeight)},cfg.animateDuration,"cubicInOut");}catch(e){}try{parent.fcObj.contentResetHeight();}catch(e){}try{parent.fnObj.contentResetHeight(null,bodyHeight+100);}catch(e){}},50);},onDocResize:function(){var cfg=this.config;if(cfg.mediaQuery){var _viewMode="",clientWidth=axf.clientWidth();axf.each(cfg.mediaQuery,function(k,v){if(Object.isObject(v)){if(v.min!=undefined&&v.max!=undefined){if(v.min<=clientWidth&&clientWidth<=v.max){_viewMode=(k=="dx")?"dx":"mx";return false;}}else{if(v.min<=clientWidth){_viewMode=(k=="dx")?"dx":"mx";return false;}}}});if(_viewMode!=""){cfg.viewMode=_viewMode;}}if(cfg.viewMode=="dx"){try{if(cfg.fixedWidth){var maskWidth,maskLeft;if(cfg.opendModalID!=""){maskWidth=axdom("#"+cfg.opendModalID).outerWidth();if(maskWidth!=axdom("#"+cfg.opendModalID).data("width")){axdom("#"+cfg.opendModalID).css({top:axdom("#"+cfg.opendModalID).data("top"),width:axdom("#"+cfg.opendModalID).data("width")});}maskLeft=(axdom(document.body).width()/2)-(maskWidth/2);if(maskLeft<0)maskLeft=0;axdom("#"+cfg.opendModalID).css({left:maskLeft});}else{maskWidth=axdom("#"+cfg.windowID).outerWidth();if(maskWidth!=axdom("#"+cfg.windowID).data("width")){axdom("#"+cfg.windowID).css({top:axdom("#"+cfg.windowID).data("top"),width:axdom("#"+cfg.windowID).data("width")});}maskLeft=(axdom(document.body).width()/2)-(maskWidth/2);if(maskLeft<0)maskLeft=0;axdom("#"+cfg.windowID).css({left:maskLeft});}}else{if(cfg.opendModalID!=""){maskWidth=axdom(".container").width()-50;axdom("#"+cfg.opendModalID).css({width:maskWidth});}else{maskWidth=axdom(".container").width()-50;axdom("#"+cfg.windowID).css({width:maskWidth});}}}catch(e){}}else if(cfg.viewMode=="mx"){if(cfg.opendModalID!=""){axdom("#"+cfg.opendModalID).css({left:0,top:axdom(window).scrollTop(),width:"100%"});}else{axdom("#"+cfg.windowID).css({left:0,top:axdom(window).scrollTop(),width:"100%"});}}},loaded:function(){var cfg=this.config,_winID=this.winID;var loadingID=this.config.windowID+"_loading";var myIframe=window[this.winID];var doc=(myIframe.contentDocument)?myIframe.contentDocument:myIframe.contentWindow.document;var bodyHeight=axdom(doc).innerHeight();if(doc.body&&axdom(doc.body).find("."+cfg.contentDivClass).get(0)){bodyHeight=axdom(doc.body).find("."+cfg.contentDivClass).outerHeight();}axdom(this).css({height:(bodyHeight)},cfg.animateDuration,"cubicInOut");axdom("#"+_winID+"_box").css({height:(bodyHeight)},cfg.animateDuration,"cubicInOut");if(cfg.displayLoading)axdom("#"+loadingID).fadeOut("slow");axdom("#"+_winID).addClass("loaded");}});